                while (1) {
                    /* do some work for awhile */

                    ...

                    /* check if there is a cancellation request */
                    pthread testcancel();
                }
